<!DOCTYPE html>
<!-- saved from url=(0031)https://www.szbookmall.com/cart -->
<html lang="zh">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<link rel="icon" href="https://www.szbookmall.com/favicon.ico">
	<title>深圳书城——深圳书城唯一官方网站</title>
	<link href="/css/cultural_details_merchant_mycart.079a84ba.css" rel="prefetch">
	<link href="/css/cultural_merchant_orderPay_submitorder.7004d066.css" rel="prefetch">
	<link href="/css/cultural_merchant_submitorder.5507b350.css" rel="prefetch">
	<link href="/css/details_mycart_orderPay_search.b5f435f0.css" rel="prefetch">
	<link href="/css/home.f3f31cff.css" rel="prefetch">
	<link href="/css/merchant.7f5631e5.css" rel="prefetch">
	<link href="/css/mycart.60a6206d.css" rel="prefetch">
	<link href="/css/orderPay.ef5233cd.css" rel="prefetch">
	<link href="/js/cultural_details_merchant_mycart.4022eafb.js" rel="prefetch">
	<link href="/js/cultural_merchant_orderPay_submitorder.74b8e949.js" rel="prefetch">
	<link href="/js/cultural_merchant_submitorder.b73bf004.js" rel="prefetch">
	<link href="/js/details_merchant_submitorder.ecbe09f1.js" rel="prefetch">
	<link href="/js/details_mycart_orderPay_search.bd179746.js" rel="prefetch">
	<link href="/js/home.87b6fbb6.js" rel="prefetch">
	<link href="/js/merchant.0ed56863.js" rel="prefetch">
	<link href="/js/mycart.4a33c6dc.js" rel="prefetch">
	<link href="/js/orderPay.87b69fcf.js" rel="prefetch">
	<link href="/css/app.5ca165e5.css" rel="preload" as="style">
	<link href="/css/chunk-vendors.68bf6ad5.css" rel="preload" as="style">
	<link href="/js/app.06589e7e.js" rel="preload" as="script">
	<link href="/js/chunk-vendors.89a26db2.js" rel="preload" as="script">
	<link href="/css/chunk-vendors.68bf6ad5.css" rel="stylesheet">
	<link href="/css/app.5ca165e5.css" rel="stylesheet">
	<link rel="stylesheet" type="text/css" href="/css/home.f3f31cff.css">
	<script charset="utf-8" src="/js/home.87b6fbb6.js"></script>
	<link rel="stylesheet" type="text/css" href="/css/cultural_merchant_orderPay_submitorder.7004d066.css">
	<script charset="utf-8" src="/js/cultural_merchant_orderPay_submitorder.74b8e949.js"></script>
	<link rel="stylesheet" type="text/css" href="/css/cultural_details_merchant_mycart.079a84ba.css">
	<script charset="utf-8" src="/js/cultural_details_merchant_mycart.4022eafb.js"></script>
	<script charset="utf-8" src="/js/details_merchant_submitorder.ecbe09f1.js"></script>
	<link rel="stylesheet" type="text/css" href="/css/cultural_merchant_submitorder.5507b350.css">
	<script charset="utf-8" src="/js/cultural_merchant_submitorder.b73bf004.js"></script>
	<link rel="stylesheet" type="text/css" href="/css/merchant.7f5631e5.css">
	<script charset="utf-8" src="/js/merchant.0ed56863.js"></script>
	<link rel="stylesheet" type="text/css" href="/css/details_mycart_orderPay_search.b5f435f0.css">
	<script charset="utf-8" src="/js/details_mycart_orderPay_search.bd179746.js"></script>
	<link rel="stylesheet" type="text/css" href="/css/orderPay.ef5233cd.css">
	<script charset="utf-8" src="/js/orderPay.87b69fcf.js"></script>
	<link rel="stylesheet" type="text/css" href="/css/mycart.60a6206d.css">
	<link rel="stylesheet" href="/css/rep.css">
	<script charset="utf-8" src="/js/mycart.4a33c6dc.js"></script>
</head>
<body>
<div data-v-0fa58336="" id="app">
	<div data-v-16d07261="" data-v-0fa58336="" class="top-header-box">
		<div data-v-16d07261="" class="margin-auto max-width clearfix">
			<div data-v-16d07261="" class="notice-box">
				<div data-v-16d07261="" class="notice-box-img"><img data-v-16d07261="" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAAeP4ixAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQ1IDc5LjE2MzQ5OSwgMjAxOC8wOC8xMy0xNjo0MDoyMiAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTkgKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjA5Nzk5RTQwQjM2NzExRTk4QjM0OEJBMUQ0RDgyODQ0IiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjA5Nzk5RTQxQjM2NzExRTk4QjM0OEJBMUQ0RDgyODQ0Ij4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6MDk3OTlFM0VCMzY3MTFFOThCMzQ4QkExRDREODI4NDQiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6MDk3OTlFM0ZCMzY3MTFFOThCMzQ4QkExRDREODI4NDQiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz6nCeKrAAACnElEQVR42uyZT0gUURzHZ9ctlbRExbU/UlGooYl5KLxEgXVSDKtLRCcvEeqtW5c6BB0iCrxJhw4ewosapCcLIgI7VBAURoeUgiiVIoqs6fPot7AOM+7O251/y/zgw8LMe79533nzfu/3fpswTdMoBUsaJWKxkFhILCQWEshYbsIknHHdW+0jISAFd831ds2NjzCISMO0aW99URFyEhZMZ3sFm/PxFdQaaYRRmIF9G7Rrh+NhXOxVMALzcDHPPgP5NEr5JKAezsElaHbZ9yhsgt8bNUp4mP2WwWG4AP2wXdPPGrTBWz9nZCd0yXet6CyCTzXGA8UWUgFbYKss2N1Ci7y1VrlXbGvRWSNqgLflnvruEnAfxuG6fOvVUOljkNirI0S90bOWawsiJA0NAYTrHTrh969NhPiVtfCCsAYdIWG0mlxjjYoQFWTKS0FIKleEjQ9WPpsKMn9KQchPIfJCvsi2EHkhSzprJClpszX8GT6nJdn2RidFWYUxScMz9lR+H2cljOq3Tg5LCY+FPM/VoJDzSKUcmJSgXbAHOuAg7C/g/GG1b5L9fgziYFUjDz8GJ+AQ1Gr6egC9Xs5It+Wc8AkeOrRNy5F1QITVuXhOH0x7WaC7YyndrEB1Hv0aYUhKPbnsESS9rmsN2jz4lIv+5TAMSw4ilqHNjwJdO6xZHj6r4acJpix+PkOPXyVTNeXzNm+yV9PfFViEe9Dstn+hJc8RGyEf5C3r+NumO5ZCw68Kqa8lKmXbM+iB71FJ47/CLZvrR6TyUuWXkGJsiKo09MKhZDMHp0Vw6A9WKoW47HBP7exXozIjGZsw7Cvn743/fx2YYZ+RjA3DouXaO7jhtQgvkkZV+z0Py/AEXsKPqH1acRUlFhILCbH9E2AAI3lP8Xm5eaYAAAAASUVORK5CYII="
																	alt=""></div>
				<div data-v-16d07261="" class="seamless-warp2">
					<!---->
					<!---->
					<div style="transform: translate(-140px, 0px); transition: all 0ms ease-in 0s; overflow: hidden; width: 401px;">
						<div style="float: left; overflow: hidden;">
							<ul data-v-16d07261="" class="item">
								<li data-v-16d07261="">深圳书城金山大厦招租公告</li>
								<li data-v-16d07261="">深圳书城金山大厦招租公告</li>
							</ul>
						</div>
						<div style="float: left; overflow: hidden;">
							<ul data-v-16d07261="" class="item">
								<li data-v-16d07261="">深圳书城金山大厦招租公告</li>
								<li data-v-16d07261="">深圳书城金山大厦招租公告</li>
							</ul>
						</div>
					</div>
				</div>
			</div>
			<ul data-v-16d07261="" class="top-nav">
				<li data-v-16d07261=""><a data-v-16d07261="" href="javascript:void (0)"><span data-v-16d07261="">欢迎光临深圳书城 </span><span
						data-v-16d07261="">17863957393</span><span data-v-16d07261="" class="loginOut">退出登录</span></a></li>
				<li data-v-16d07261=""><a data-v-16d07261="" href="https://www.szbookmall.com/user/order" class="">我的订单</a></li>
			</ul>
		</div>
	</div>
	<div data-v-248f958f="" data-v-0fa58336="" class="logoandsearchbox margin-auto max-width clearfix">
		<div data-v-248f958f="" class="fl">
			<div data-v-248f958f="" class="logo router-link-active"><img data-v-248f958f="" src="/img/pc_logo.5cb2ed14.png"
																		 alt=""></div>
		</div>
		<div data-v-248f958f="" class="fl logo-desc-title"> 在每一个美好的思想前停留</div>
		<div data-v-248f958f="" class="fr right-box">
			<form data-v-248f958f="" class="fl search-box"><input data-v-248f958f="" type="search" placeholder="书名、作者、ISBN"
																  class="searchInput">
				<div data-v-248f958f="" class="search-icon"></div>
				<ul data-v-248f958f="" class="search-list" style="display: none;"></ul>
			</form>
			<div data-v-248f958f="" class="fl top-icon">
				<div data-v-248f958f="" class="icon-cart"></div>
				<div data-v-248f958f="" class="cartCount">{{totalNum}}</div>
				<div data-v-248f958f="" class="top-cart-list-box" style="">





					<div v-for="(shopping,index) in shoppingList" data-v-0f64cdbe="" class="car-list-line-box b-1px-b-dashed">


						<div data-v-0f64cdbe="" class="car-list flex-row flex-y-center">
							<i data-v-0f64cdbe="">
								<a data-v-0f64cdbe="" href="https://www.szbookmall.com/detail/39666"
								   target="_blank">
									<img data-v-0f64cdbe="" alt="" data-src="http://image.szbookmall.com/Upload/Images/WLKJ_V2/39/66/39666_000.jpg"
										 src="/img/39666_000.jpg" lazy="loaded">
								</a>
							</i>

							<div data-v-0f64cdbe="" class="flex-grow-0 flex-x-center orderPrice li99"> {{shopping.book.bookName}}&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp单价：</div>
							<div data-v-0f64cdbe="" class="flex-grow-0 flex-x-center orderPrice li3"> ¥{{shopping.book.price}}&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp数量:</div>
							<div data-v-0f64cdbe="" class="flex-grow-0 flex-x-center orderPrice li98">{{shopping.num}}&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp</div>
							<div data-v-0f64cdbe="" class="flex-grow-0 flex-x-center status li5"> 小计:{{shopping.num*shopping.book.price}}&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp</div>
						</div>
					</div>


					<div data-v-248f958f="" class="top-cart-footer clearfix">
						<div data-v-248f958f="" class="fl left-text">合计（不含服务费）<span data-v-248f958f="" class="red totalPrice">￥{{totalPrice11}}</span></div>

						<a data-v-248f958f="" href="http://localhost:8080/pages/shopping_cart.html" target="_blank" class="fr right-btn router-link-exact-active router-link-active">去购物车结算</a>
					</div>






				</div>
			</div>
			<div data-v-248f958f="" class="fl top-icon">
				<div data-v-248f958f="" class="message"></div>
			</div>
			<div data-v-248f958f="" class="fl top-icon">
				<div data-v-248f958f="" class="person-icon"></div>
			</div>
		</div>
	</div>
	<!--购物车-->
	<div data-v-0fa58336="" class="common-container">
		<div data-v-0f64cdbe="" data-v-0fa58336="" class="cartContainer max-width margin-auto">
			<div data-v-0f64cdbe="" class="cartBox">
				<div data-v-41080b36="" data-v-0f64cdbe="" class="orderTabs">
					<ul data-v-41080b36="" class="">
						<li data-v-41080b36="" class="on">
							<p data-v-41080b36="">全部商品 <span data-v-41080b36="">{{totalNum}}</span></p>
						</li>
					</ul>
				</div>
				<div data-v-0f64cdbe="">
					<ul data-v-0f64cdbe="" class="headTop flex-row flex-y-center">
						<li data-v-0f64cdbe="" class="li1 allProduct no-center flex-row flex-y-center">
									<span data-v-0f64cdbe="" class="all-select-box flex-grow-0 flex-y-center">
										<!--全选按钮-->
										<input @click="selectAll"  :checked="selectedShoppingList.length==shoppingList.length"  data-v-0f64cdbe="" type="checkbox">全选</span>商品 </li>
						<li data-v-0f64cdbe="" class="li2 flex-grow-0">规格</li>
						<li data-v-0f64cdbe="" class="li3 flex-grow-0">单价</li>
						<li data-v-0f64cdbe="" class="li4 flex-grow-0">数量</li>
						<li data-v-0f64cdbe="" class="li5 flex-grow-0">小计</li>
						<li data-v-0f64cdbe="" class="li6 flex-grow-0">操作</li>
					</ul>
					<div data-v-0f64cdbe="" class="nodata" style="display: none;"><img data-v-0f64cdbe="" src="/img/Blank.b0b6f803.png"
																					   alt=""></div>
					<div data-v-0f64cdbe="" class="cart_store_book">
						<!--遍历购物车-->
						<div v-for="(shopping,index) in shoppingList" data-v-0f64cdbe="" class="car-list-line-box b-1px-b-dashed">
									<span data-v-0f64cdbe="" class="flex-grow-0 bookAcivity"
										  style="display: none;">会员日购买该商品可享8.8折</span>
							<div data-v-0f64cdbe="" class="car-list flex-row flex-y-center">
								<div data-v-0f64cdbe="" class="flex-grow-0 flex-y-center goods li1">
									<!--单选
                                        indexOf:判断当前数组中是否存在某个元素,如果存在，返回对应的下标，如果不存在，返回-1
                                        单选：传递对应的下标
                                    -->
									<input @click="selectOne(index)" :checked="selectedShoppingList.indexOf(shopping.sid)>=0"  data-v-0f64cdbe="" type="checkbox"
										   class="list-input-checkbox">
									<i data-v-0f64cdbe="">
										<a data-v-0f64cdbe="" href="https://www.szbookmall.com/detail/39666"
										   target="_blank">
											<img data-v-0f64cdbe="" alt="" data-src="http://image.szbookmall.com/Upload/Images/WLKJ_V2/39/66/39666_000.jpg"
												 src="/img/39666_000.jpg" lazy="loaded">
										</a>
									</i>
									<a data-v-0f64cdbe="" href="https://www.szbookmall.com/detail/39666"
									   target="_blank" class="orderName">{{shopping.book.bookName}}</a>
								</div>
								<div data-v-0f64cdbe="" class="flex-grow-0 flex-col spec li2">
									<div data-v-0f64cdbe="" class="flex-x-center">暂无</div>
								</div>
								<div data-v-0f64cdbe="" class="flex-grow-0 flex-x-center orderPrice li3"> {{shopping.book.price}}<span data-v-0f64cdbe=""
																																	   class="line">¥{{shopping.book.salePrice}}</span><span data-v-0f64cdbe="" class="order-price-desc" style="display: none;">
												比加入购物车时降价 ¥{{shopping.book.price-shopping.book.salePrice}} </span></div>
								<div data-v-0f64cdbe="" class="flex-grow-0 flex-x-center orderCount li4">



									<div data-v-0f64cdbe="" class="el-input-number el-input-number--small"><span role="button" class="el-input-number__decrease >
                                        class="el-icon-minus></span><span role="button" class="el-input-number__increase"></span>
										<span @click="changeNum(0,index)"role="button"class="el-input-number__decrease">-</span>
										<span @click="changeNum(1,index)" role="button" class="el-input-number__increase">+</span>
										<div class="el-input el-input--small">

											<!--数量--><input v-model="shopping.num" type="text" autocomplete="off" max="Infinity" min="1" class="el-input__inner" role="spinbutton"

															aria-valuemax="Infinity" aria-valuemin="1" aria-valuenow="1" aria-disabled="undefined">

										</div>
									</div>
								</div>


								<div data-v-0f64cdbe="" class="flex-grow-0 flex-x-center status li5"> {{shopping.num*shopping.book.price}}</div>
								<div data-v-0f64cdbe="" class="flex-grow-0 flex-x-center other li6 ">
									<div data-v-0f64cdbe="">
										<div data-v-0f64cdbe="" class="hover">删除</div>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
				<div data-v-0f64cdbe="" class="cartbox-bottom b-1px flex-row flex-y-center">
					<div data-v-0f64cdbe="" class="flex-row count-price-box flex-grow-1 flex-right">
						<div data-v-0f64cdbe="" class="price-left flex-y-center">合计（不含运费）</div>
						<div data-v-0f64cdbe="" class="mainred totalprice">¥ {{totalPrice}}</div>
					</div>
					<div @click="submitMoney"  style="background: #b8494a" data-v-0f64cdbe="" class="flex-grow-0 paybtn flex-x-center flex-y-center"> 结算 </div>
				</div>
			</div>
		</div>
	</div>
</div>
</body>
<script type="text/javascript" src="/js/vue.js" ></script>
<script type="text/javascript" src="/js/axios.min.js" ></script>
<script type="text/javascript">
    var vm = new Vue({
        el:"#app",
        data:{
            shoppingList:[],//购物车列表
            selectedShoppingList:[],//存储被选择的购物车的id



        },


        mounted:function () {
            //根据用户id查询购物车列表
            axios.post("/books/getShoppingList")
                .then(function (res) {
                    vm.shoppingList = res.data.data;
                })
        },
        methods:{
            //全选
            selectAll:function () {
                var that = this;
                //判断按钮的选中状态
                //如果是true 被选中  false:取消选中
                if(!event.currentTarget.checked){
                    //取消全选
                    that.selectedShoppingList = [];
                }else{
                    //清空原来添加的元素
                    that.selectedShoppingList = [];
                    //全选
                    //遍历所有的购物车列表
                    //v:取到每一个元素
                    //i:每一个元素的下标
                    this.shoppingList.forEach(function (v,i) {
                        //push:元素添加到数组中
                        that.selectedShoppingList.push(v.sid);
                    })
                }
                console.log(that.selectedShoppingList);
            },
            //单选
            selectOne:function (index) {
                var that = this;
                if(event.currentTarget.checked){
                    //勾选
                    that.selectedShoppingList.push(that.shoppingList[index].sid);
                }else{
                    //遍历所有被选中的购物车数组
                    for(var i=0;i<that.selectedShoppingList.length;i++){
                        if(that.shoppingList[index].sid==that.selectedShoppingList[i]){
                            //取消勾选
                            //splice(a,b)：从下标a开始删除，删除b个
                            // i:找到的要被删除的sid的下标
                            that.selectedShoppingList.splice(i,1);
                            break;
                        }
                    }
                }
                console.log(that.selectedShoppingList);
            },
            changeNum:function (flag,index) {
                var that = this;
                var tag = 0;

                if(flag==0){
                    tag = -1;
                    if(that.shoppingList[index].num>1)
                    {that.shoppingList[index].num =that.shoppingList[index].num-1;}
                    else{
                        alert("最少购买一本");
                    }
                }else{
                    tag = 1;
                    if(that.shoppingList[index].num<=that.shoppingList[index].book.count-1)
                    {that.shoppingList[index].num = that.shoppingList[index].num+1;}
                    else{
                        alert("已达到最大库存");
                    }

                }

                axios.post("/books/addShopping",{
                    bid:that.shoppingList[index].book.bookId,
                    num:tag
                }).then()

            },


            //点击结算
            submitMoney:function () {
                axios.post("/orders/add",{
                    //被选中要去结算的sid数组
                    sids:this.selectedShoppingList,
                    totalMoney:this.totalPrice
                })
                    .then(function (res) {
                        if(res.data.code==0){
                            //接收到订单主表的oid，传给订单界面使用，订单页面查询订单详情
                            window.localStorage.setItem("oid",res.data.data);
                            window.location.href = "/pages/order.html";
                        }else{
                            alert(res.data.msg);
                        }
                    })
            }
        },
        //computed：监控自己定义的变量，只要变量更改，都会触发
        computed:{
            //总金额
            totalPrice:function () {
                var totalPrice = 0;
                var that = this;
                //遍历所有的购物车数组
                that.shoppingList.forEach(function (v,i) {
                    //判断每一个元素在selectedShoppingList中是否存在，如果有，计算加个，没有，直接跳过
                    if(that.selectedShoppingList.indexOf(v.sid)>=0){
                        totalPrice += v.book.price*v.num;
                    }
                })
                return totalPrice;
            },
            totalPrice11:function () {
                var totalPrice11 = 0;
                var that = this;
                //遍历所有的购物车数组
                that.shoppingList.forEach(function (v,i) {
                    totalPrice11 += v.book.price*v.num;
                })
                return totalPrice11;
            },

            totalNum:function () {
                var totalNum = 0;
                var that = this;
                totalNum = that.shoppingList.length;
                return totalNum;

            }
        }
    })
</script>

</html>
